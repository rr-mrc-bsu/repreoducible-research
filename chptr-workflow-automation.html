<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>5 Build automation | A Reproducible Research Compendium</title>
  <meta name="description" content="This compendium is inteded is intended to be a growing knowledge base on reproducible research and by writing it collaboratively acts as learning-by-doing example on modern collaborative coding workflows and version control.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="5 Build automation | A Reproducible Research Compendium" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This compendium is inteded is intended to be a growing knowledge base on reproducible research and by writing it collaboratively acts as learning-by-doing example on modern collaborative coding workflows and version control." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Build automation | A Reproducible Research Compendium" />
  
  <meta name="twitter:description" content="This compendium is inteded is intended to be a growing knowledge base on reproducible research and by writing it collaboratively acts as learning-by-doing example on modern collaborative coding workflows and version control." />
  

<meta name="author" content="cf. list of contributors at https://github.com/rr-mrc-bsu/reproducible-research/graphs/contributors">


<meta name="date" content="2019-03-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chptr-literate-programming.html">
<link rel="next" href="dependency-management.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Reproducible Research Compendium</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> A ‘Living Book’ - aims and scope</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#other-rescources"><i class="fa fa-check"></i><b>1.1</b> Other rescources</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#our-definition-of-reproducible-research"><i class="fa fa-check"></i><b>1.2</b> Our definition of ‘Reproducible Research’</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html"><i class="fa fa-check"></i><b>2</b> How to contribute</a><ul>
<li class="chapter" data-level="2.1" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#before-you-start"><i class="fa fa-check"></i><b>2.1</b> Before you start</a></li>
<li class="chapter" data-level="2.2" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#cloning-getting-the-books-source-code"><i class="fa fa-check"></i><b>2.2</b> Cloning: Getting the book’s source code</a></li>
<li class="chapter" data-level="2.3" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#creating-a-new-branch"><i class="fa fa-check"></i><b>2.3</b> Creating a new ‘branch’</a></li>
<li class="chapter" data-level="2.4" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#creating-a-new-chapter"><i class="fa fa-check"></i><b>2.4</b> Creating a new chapter</a></li>
<li class="chapter" data-level="2.5" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#committing-your-changes"><i class="fa fa-check"></i><b>2.5</b> Committing your changes</a></li>
<li class="chapter" data-level="2.6" data-path="chptr-how-to-contribute.html"><a href="chptr-how-to-contribute.html#publishing-your-changes"><i class="fa fa-check"></i><b>2.6</b> Publishing your changes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chptr-version-control.html"><a href="chptr-version-control.html"><i class="fa fa-check"></i><b>3</b> Version control</a></li>
<li class="chapter" data-level="4" data-path="chptr-literate-programming.html"><a href="chptr-literate-programming.html"><i class="fa fa-check"></i><b>4</b> Literate Programming</a></li>
<li class="chapter" data-level="5" data-path="chptr-workflow-automation.html"><a href="chptr-workflow-automation.html"><i class="fa fa-check"></i><b>5</b> Build automation</a><ul>
<li class="chapter" data-level="5.1" data-path="chptr-workflow-automation.html"><a href="chptr-workflow-automation.html#makefiles"><i class="fa fa-check"></i><b>5.1</b> Makefiles</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dependency-management.html"><a href="dependency-management.html"><i class="fa fa-check"></i><b>6</b> Dependency management</a><ul>
<li class="chapter" data-level="6.1" data-path="dependency-management.html"><a href="dependency-management.html#example-problem"><i class="fa fa-check"></i><b>6.1</b> Example problem</a></li>
<li class="chapter" data-level="6.2" data-path="dependency-management.html"><a href="dependency-management.html#virtual-machines-and-containers"><i class="fa fa-check"></i><b>6.2</b> Virtual machines and containers</a><ul>
<li class="chapter" data-level="6.2.1" data-path="dependency-management.html"><a href="dependency-management.html#sct-docker"><i class="fa fa-check"></i><b>6.2.1</b> Docker</a></li>
<li class="chapter" data-level="6.2.2" data-path="dependency-management.html"><a href="dependency-management.html#singularity"><i class="fa fa-check"></i><b>6.2.2</b> Singularity</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="dependency-management.html"><a href="dependency-management.html#the-dockerfile"><i class="fa fa-check"></i><b>6.3</b> The dockerfile</a></li>
<li class="chapter" data-level="6.4" data-path="dependency-management.html"><a href="dependency-management.html#sct-container-workflow-manager"><i class="fa fa-check"></i><b>6.4</b> Containers and workflow management</a><ul>
<li class="chapter" data-level="6.4.1" data-path="dependency-management.html"><a href="dependency-management.html#gnu-make"><i class="fa fa-check"></i><b>6.4.1</b> GNU make</a></li>
<li class="chapter" data-level="6.4.2" data-path="dependency-management.html"><a href="dependency-management.html#snakemake"><i class="fa fa-check"></i><b>6.4.2</b> Snakemake</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="dependency-management.html"><a href="dependency-management.html#containerization-vs.package-managers"><i class="fa fa-check"></i><b>6.5</b> Containerization vs. package managers</a><ul>
<li class="chapter" data-level="6.5.1" data-path="dependency-management.html"><a href="dependency-management.html#r-only---wrap-everything-up-in-a-package"><i class="fa fa-check"></i><b>6.5.1</b> R only - wrap everything up in a package</a></li>
<li class="chapter" data-level="6.5.2" data-path="dependency-management.html"><a href="dependency-management.html#r-only---packrat"><i class="fa fa-check"></i><b>6.5.2</b> R only - packrat</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dependency-management.html"><a href="dependency-management.html#caveats"><i class="fa fa-check"></i><b>6.6</b> Caveats</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chptr-continuous-integration.html"><a href="chptr-continuous-integration.html"><i class="fa fa-check"></i><b>7</b> Continuous Integration</a></li>
<li class="chapter" data-level="8" data-path="chptr-metadata.html"><a href="chptr-metadata.html"><i class="fa fa-check"></i><b>8</b> Metadata</a><ul>
<li class="chapter" data-level="8.1" data-path="chptr-metadata.html"><a href="chptr-metadata.html#sct-fair"><i class="fa fa-check"></i><b>8.1</b> FAIR principle</a></li>
<li class="chapter" data-level="8.2" data-path="chptr-metadata.html"><a href="chptr-metadata.html#sct-doi"><i class="fa fa-check"></i><b>8.2</b> Digintal Object Identifiers - DOI</a></li>
<li class="chapter" data-level="8.3" data-path="chptr-metadata.html"><a href="chptr-metadata.html#sct-zenodo"><i class="fa fa-check"></i><b>8.3</b> Zenodo.org</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="r-package-development.html"><a href="r-package-development.html"><i class="fa fa-check"></i><b>9</b> R package development</a><ul>
<li class="chapter" data-level="9.1" data-path="r-package-development.html"><a href="r-package-development.html#continuous-integration"><i class="fa fa-check"></i><b>9.1</b> Continuous integration</a></li>
<li class="chapter" data-level="9.2" data-path="r-package-development.html"><a href="r-package-development.html#unit-testing"><i class="fa fa-check"></i><b>9.2</b> Unit testing</a></li>
<li class="chapter" data-level="9.3" data-path="r-package-development.html"><a href="r-package-development.html#documentation"><i class="fa fa-check"></i><b>9.3</b> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="python-package-development.html"><a href="python-package-development.html"><i class="fa fa-check"></i><b>10</b> Python package development</a><ul>
<li class="chapter" data-level="10.1" data-path="python-package-development.html"><a href="python-package-development.html#continuous-integration-1"><i class="fa fa-check"></i><b>10.1</b> Continuous integration</a></li>
<li class="chapter" data-level="10.2" data-path="python-package-development.html"><a href="python-package-development.html#unit-testing-1"><i class="fa fa-check"></i><b>10.2</b> Unit testing</a></li>
<li class="chapter" data-level="10.3" data-path="python-package-development.html"><a href="python-package-development.html#documentation-1"><i class="fa fa-check"></i><b>10.3</b> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Reproducible Research Compendium</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chptr-workflow-automation" class="section level1">
<h1><span class="header-section-number">5</span> Build automation</h1>
<p>Large projects can be a pain to manage. Small changes may break your software, or may deem your previously obtained analysis results useless. Build automation refers to a collection of tools that atempt to automate steps in your workflow, thereby simplifying your the whole process. Many processes may be automated, but here we will mainly discuss build automation using Makefiles.</p>
<div id="makefiles" class="section level2">
<h2><span class="header-section-number">5.1</span> Makefiles</h2>
<p>Most research projects consist of several different connected components. For example, the end product might be a manuscipt, which depends on intermediate components such as a data analysis script and an R package. In this case, the manuscript depends on the data analysis script, which in turn depends on the R package. Such a hierarchy implies that every time a file changes, all files downstream in the hierarchy should be updated as well. In the previous example, we might adjust a function in the R package, which might change the outcome of the data analysis, and as a result, we’d have to re-run the data analysis script. The outcome of the data analysis might change the manuscript, so we’d have to re-compile that as well. In large projects, this quickly becomes tedious and difficult to maintain by hand. Luckily there is software available to streamline this process.</p>
<p>Consider the more complicated example in Figure <a href="chptr-workflow-automation.html#fig:workflow-diagram">5.1</a> with the following corresponding project directory:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="ex">./</span>
├── <span class="ex">rpackage</span>
│   ├── <span class="ex">DESCRIPTION</span>
│   └── <span class="ex">functions.R</span>
├── <span class="ex">code</span>
│   ├── <span class="ex">analysis.R</span>
│   └── <span class="ex">simulation.R</span>
├── <span class="ex">docs</span>
│   ├── <span class="ex">manuscript.Rnw</span>
│   ├── <span class="ex">presentation.Rnw</span>
│   └── <span class="ex">refs.bib</span>
└── <span class="ex">README.md</span></code></pre></div>
<p>[to do: make diagram with DiagrammeR]</p>
<div class="figure"><span id="fig:workflow-diagram"></span>
<img src="10-build-automation_files/figure-html/workflow-diagram-1.png" alt="Example project workflow" width="672" />
<p class="caption">
Figure 5.1: Example project workflow
</p>
</div>
<p>Re-running, -building, and -compiling all the files after we made a change to the anyone of the intermediate files would be a tedious task. Ideally, we would like to have a command that re-runs/compiles/builds the different files everytime an upstream change is made. This is exactly what the GNU software Make does. Make works through a Makefile, a file that describes how a target file, depends on its dependencies, and how these in turn on their dependencies, and so on. If a Makefile is run, a file is compiled if any of its dependencies has changed since the last time the file was compiled. In other words, the Makefile starts at the top of the hierarchy and updates a file if its creation time is older than the creation time of its dependencies. In our example in Figure <a href="chptr-workflow-automation.html#fig:workflow-diagram">5.1</a>, if we make a change to the functions.R file, we trigger the recompilation of the recompilation of the r-package.tar.gz file, which in turn triggers a rerunning of the analysis.R and simulation.R scripts, and so on, until all files are up to date again.</p>
<p>[add example Makefile]</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chptr-literate-programming.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dependency-management.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rr-mrc-bsu/reproducible-research/blob/master/10-build-automation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["reproducible-research.pdf", "reproducible-research.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
